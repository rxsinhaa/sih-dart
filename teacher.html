<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teacher Dashboard - Dart Institute of Technology</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display.swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .timetable-grid { display: grid; grid-template-columns: 100px repeat(4, 1fr); grid-template-rows: 40px repeat(5, 1fr); gap: 4px; }
        .grid-header { font-weight: 600; display: flex; align-items: center; justify-content: center; background-color: #f3f4f6; border-radius: 0.375rem; padding: 0.5rem; }
        .grid-cell { 
            border-radius: 0.375rem; padding: 0.75rem; min-height: 80px; display: flex; flex-direction: column; 
            justify-content: center; align-items: center; text-align: center; background-color: #ffffff; 
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); 
            transition: all 0.2s cubic-bezier(0.25, 0.8, 0.25, 1);
            border: 1px solid transparent;
        }
        .tutorial-slot {
            background-color: #ffffff !important; 
            border: 2px solid #312e81;
            color: #1e1b4b; 
        }
        .tutorial-slot .teacher-name {
            color: #312e81;
        }
        .day-label { font-weight: 600; display: flex; align-items: center; justify-content: center; }
        .subject-name { font-weight: 600; font-size: 0.875rem; }
        .teacher-name { font-size: 0.75rem; color: #4b5563; }
        .tab-button { transition: background-color 0.3s, color 0.3s; }
        .tab-button.active { background-color: #4f46e5; color: white; }
        
        /* Class to apply blur effect to the main content */
        .content-blurred {
            filter: blur(8px);
            transition: filter 0.3s ease-in-out;
            pointer-events: none; /* Disables interaction with blurred content */
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 flex flex-col min-h-screen">

    <div id="login-overlay" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-xl shadow-2xl p-8 w-full max-w-sm">
            <div class="text-center mb-6">
                <h2 class="text-2xl font-extrabold text-gray-900">Teacher Login</h2>
                <p class="text-gray-500 mt-1">Please sign in to access your dashboard.</p>
            </div>
            <form id="login-form">
                <div class="space-y-4">
                    <div>
                        <label for="teacher-select" class="text-sm font-medium text-gray-700">Select Your Name</label>
                        <select id="teacher-select" required class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                            </select>
                    </div>
                    <div>
                        <label for="password" class="text-sm font-medium text-gray-700">Password</label>
                        <input type="password" id="password" required class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                    </div>
                </div>
                 <p id="error-message" class="text-sm text-red-600 mt-2 h-4"></p> <div class="mt-6">
                    <button type="submit" class="w-full bg-indigo-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">Login</button>
                </div>
            </form>
        </div>
    </div>

    <div id="main-content">
        <nav class="bg-white shadow-md sticky top-0 z-40">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-between h-16">
                    <div class="flex items-center space-x-3">
                        <svg class="h-8 w-8 text-indigo-600" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z"/> <path d="M3 12h2l2 -9l2 18l2 -9l2 9l2 -18l2 9h2" />
                        </svg>
                        <span class="font-bold text-xl text-indigo-600">Dart Institute of Technology</span>
                    </div>
                    <div class="hidden md:block">
                        <div class="ml-10 flex items-baseline space-x-4">
                            <a href="#" class="text-gray-500 hover:text-indigo-600 px-3 py-2 rounded-md text-sm font-medium transition-colors">Dashboard</a>
                            <a href="#" class="text-gray-500 hover:text-indigo-600 px-3 py-2 rounded-md text-sm font-medium transition-colors">Profile</a>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <main class="flex-grow container mx-auto p-4 md:p-8">
            <header class="mb-8">
                <h1 class="text-3xl font-bold text-gray-900">Teacher Dashboard</h1>
                <p class="mt-1 text-gray-600">Submit requests and view the official master schedule.</p>
            </header>
            
            <div class="grid grid-cols-1 lg:grid-cols-3 lg:gap-8">
                <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-lg">
                     <h2 class="text-xl font-bold text-gray-800 mb-4">Current Master Schedule</h2>
                     <div id="timetable-display-container"></div>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-lg mb-8 lg:mb-0">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">Submit a Request to Admin</h2>
                    <form id="request-form">
                        <div class="space-y-4">
                            <div>
                                <label for="teacher-name" class="text-sm font-medium text-gray-700">Your Name</label>
                                <input type="text" id="teacher-name" required class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 bg-gray-100" readonly>
                            </div>
                            <div>
                                <label for="request-type" class="text-sm font-medium text-gray-700">Request Type</label>
                                <select id="request-type" required class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                                    <option>Schedule Change</option>
                                    <option>Leave Application</option>
                                    <option>Resource Request</option>
                                    <option>Other</option>
                                </select>
                            </div>
                            <div>
                                <label for="details" class="text-sm font-medium text-gray-700">Details</label>
                                <textarea id="details" rows="5" required class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" placeholder="Please provide all necessary details for your request..."></textarea>
                            </div>
                        </div>
                        <div class="mt-6">
                            <button type="submit" class="w-full bg-indigo-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">Submit Request</button>
                        </div>
                    </form>
                </div>
            </div>
        </main>
        
        <footer class="bg-white mt-auto">
            <div class="container mx-auto py-6 px-4 sm:px-6 lg:px-8 text-center text-gray-500">
                <p>&copy; 2025 Dart Institute of Technology. All rights reserved.</p>
            </div>
        </footer>
    </div>


    <script>
        // --- CONFIG & CREDENTIALS ---
        const config = { branches: ['ECE', 'CS', 'IT'], days: ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'], timeSlots: ['8am - 10am', '10am - 12pm', '1pm - 3pm', '3pm - 5pm'], subjectColors: { 'Elec. Eng.': 'bg-blue-100', 'Mathematics': 'bg-green-100', 'Physics': 'bg-yellow-100', 'Comp. Sci.': 'bg-purple-100' } };
        
        const teacherCredentials = {
            'Arindam': 'siharindam1',
            'Leesha': 'sihleesha1',
            'Devanshu': 'sihdevanshu1',
            'Tanmay': 'sihtanmay1'
        };

        // --- ELEMENT REFERENCES ---
        const requestForm = document.getElementById('request-form');
        const loginOverlay = document.getElementById('login-overlay');
        const mainContent = document.getElementById('main-content');
        const loginForm = document.getElementById('login-form');
        const teacherSelect = document.getElementById('teacher-select');
        const passwordInput = document.getElementById('password');
        const errorMessage = document.getElementById('error-message');

        // --- LOGIN LOGIC ---
        function populateTeacherDropdown() {
            for (const teacherName in teacherCredentials) {
                const option = document.createElement('option');
                option.value = teacherName;
                option.textContent = teacherName;
                teacherSelect.appendChild(option);
            }
        }

        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const selectedTeacher = teacherSelect.value;
            const enteredPassword = passwordInput.value;
            const correctPassword = teacherCredentials[selectedTeacher];

            if (enteredPassword === correctPassword) {
                loginOverlay.classList.add('hidden');
                mainContent.classList.remove('content-blurred');
                document.getElementById('teacher-name').value = selectedTeacher;
            } else {
                errorMessage.textContent = 'Incorrect password. Please try again.';
                passwordInput.value = '';
            }
        });

        // --- REQUEST FORM LOGIC ---
        requestForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const requestData = {
                teacherName: document.getElementById('teacher-name').value,
                requestType: document.getElementById('request-type').value,
                details: document.getElementById('details').value,
                timestamp: new Date().toISOString()
            };
            localStorage.setItem('algaba', JSON.stringify(requestData));
            alert('Your request has been successfully submitted to the admin!');
            requestForm.reset();
            document.getElementById('teacher-name').value = teacherSelect.value;
        });

        // --- TIMETABLE DISPLAY LOGIC ---
        function renderTimetableForBranch(schedule, branch, container) {
            const { days, timeSlots, subjectColors } = config;
            let gridHTML = '<div class="timetable-grid">';
            gridHTML += '<div></div>';
            timeSlots.forEach(slot => { gridHTML += `<div class="grid-header text-xs md:text-sm">${slot}</div>`; });
            days.forEach(day => {
                gridHTML += `<div class="day-label text-xs md:text-sm">${day}</div>`;
                timeSlots.forEach(slot => {
                    const classInfo = schedule[day][slot][branch];
                    if (classInfo) {
                        const colorClass = subjectColors[classInfo.subject] || 'bg-gray-100';
                        const tutorialClass = classInfo.isTutorial ? 'tutorial-slot' : '';
                        const tutorialLabel = classInfo.isTutorial ? ' (Lab)' : '';
                        gridHTML += `<div class="grid-cell ${colorClass} ${tutorialClass}"><span class="subject-name">${classInfo.subject}${tutorialLabel}</span><span class="teacher-name">${classInfo.teacher}</span></div>`;
                    } else {
                        gridHTML += '<div class="grid-cell bg-gray-50">--</div>';
                    }
                });
            });
            gridHTML += '</div>';
            container.innerHTML = gridHTML;
        }

        function loadAndDisplayTimetable() {
            const displayContainer = document.getElementById('timetable-display-container');
            const savedData = localStorage.getItem('savedTimetable');

            if (savedData) {
                const schedule = JSON.parse(savedData);
                displayContainer.innerHTML = `<div class="border-b border-gray-200 mb-4"><nav class="-mb-px flex space-x-6" id="tabs-display"></nav></div><div id="grid-display"></div>`;
                const tabsContainer = document.getElementById('tabs-display');
                const gridContainer = document.getElementById('grid-display');
                config.branches.forEach((branch, branchIndex) => {
                    const button = document.createElement('button');
                    button.className = `tab-button whitespace-nowrap py-3 px-4 border-b-2 font-medium text-sm rounded-t-md ${branchIndex === 0 ? 'active' : ''}`;
                    button.dataset.branch = branch;
                    button.textContent = `${branch} Timetable`;
                    button.addEventListener('click', (e) => {
                        tabsContainer.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
                        e.target.classList.add('active');
                        renderTimetableForBranch(schedule, e.target.dataset.branch, gridContainer);
                    });
                    tabsContainer.appendChild(button);
                });
                renderTimetableForBranch(schedule, config.branches[0], gridContainer);

            } else {
                displayContainer.innerHTML = `<div class="text-center text-gray-500 p-8 bg-gray-100 rounded-lg">No master schedule has been published by the admin yet.</div>`;
            }
        }

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            mainContent.classList.add('content-blurred');
            populateTeacherDropdown();
            loadAndDisplayTimetable();
        });
    </script>
</body>
</html>